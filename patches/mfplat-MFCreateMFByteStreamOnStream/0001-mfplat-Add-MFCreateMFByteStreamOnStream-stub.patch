From 5708796535b498be35b1ea5be561bfaf7ea420ce Mon Sep 17 00:00:00 2001
From: Alistair Leslie-Hughes <leslie_alistair@hotmail.com>
Date: Fri, 24 Aug 2018 11:20:54 +1000
Subject: [PATCH] mfplat: Add MFCreateMFByteStreamOnStream stub

Wine-Bug: https://bugs.winehq.org/show_bug.cgi?id=45372
Signed-off-by: Alistair Leslie-Hughes <leslie_alistair@hotmail.com>
---
 dlls/mfplat/main.c      | 6 ++++++
 dlls/mfplat/mfplat.spec | 2 +-
 include/mfidl.idl       | 1 +
 3 files changed, 8 insertions(+), 1 deletion(-)

diff --git a/dlls/mfplat/main.c b/dlls/mfplat/main.c
index 97b11e7..ff71ff7 100644
--- a/dlls/mfplat/main.c
+++ b/dlls/mfplat/main.c
@@ -441,6 +441,12 @@ HRESULT WINAPI MFShutdown(void)
     return S_OK;
 }
 
+HRESULT WINAPI MFCreateMFByteStreamOnStream(IStream *stream, IMFByteStream **bytestream)
+{
+    FIXME("(%p, %p): stub\n", stream, bytestream);
+    return E_NOTIMPL;
+}
+
 static HRESULT WINAPI MFPluginControl_QueryInterface(IMFPluginControl *iface, REFIID riid, void **ppv)
 {
     if(IsEqualGUID(riid, &IID_IUnknown)) {
diff --git a/dlls/mfplat/mfplat.spec b/dlls/mfplat/mfplat.spec
index 2e2204e..2534b55 100644
--- a/dlls/mfplat/mfplat.spec
+++ b/dlls/mfplat/mfplat.spec
@@ -45,7 +45,7 @@
 @ stdcall MFCreateEventQueue(ptr)
 @ stub MFCreateFile
 @ stub MFCreateLegacyMediaBufferOnMFMediaBuffer
-@ stub MFCreateMFByteStreamOnStream
+@ stdcall MFCreateMFByteStreamOnStream(ptr ptr)
 @ stub MFCreateMFVideoFormatFromMFMediaType
 @ stub MFCreateMediaBufferWrapper
 @ stub MFCreateMediaEvent
diff --git a/include/mfidl.idl b/include/mfidl.idl
index 12b351d..84be055 100644
--- a/include/mfidl.idl
+++ b/include/mfidl.idl
@@ -251,6 +251,7 @@ interface IMFGetService : IUnknown
 }
 
 cpp_quote("HRESULT WINAPI MFCreateMediaSession(IMFAttributes *config, IMFMediaSession **session);")
+cpp_quote("HRESULT WINAPI MFCreateMFByteStreamOnStream(IStream *stream, IMFByteStream **bytestream);" )
 cpp_quote("HRESULT WINAPI MFCreateSourceResolver(IMFSourceResolver **resolver);")
 cpp_quote("HRESULT WINAPI MFCreateStreamDescriptor(DWORD identifier, DWORD cMediaTypes,")
 cpp_quote("     IMFMediaType **types, IMFStreamDescriptor **descriptor);")
-- 
1.9.1

